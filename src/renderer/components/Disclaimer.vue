<template>
  <el-dialog
    :visible.sync="dialogVisibility"
    title="å£°æ˜"
    width="700px"
    :show-close="false"
    :close-on-click-modal="false"
    :close-on-press-escape="false"
    center
  >
    <div>
      å°å·¥å…·å”¯ä¸€å‘å¸ƒåœ°å€ https://github.com/SSmJaE/XueXiTongSign_Electron
    </div>
    <div>å»ºè®®ä¸¥æ ¼è®¾ç½®ç›‘æ§æ—¶é—´æ®µï¼Œå¹¶ä¸”è®¾ç½®è¾ƒå¤§çš„æ£€æµ‹é¢‘ç‡</div>
    <div>é˜²æ­¢ç»™æœåŠ¡å™¨å¸¦æ¥å‹åŠ›ï¼Œå·±æ‰€ä¸æ¬²ï¼Œå‹¿æ–½äºäºº</div>
    <div>æ„Ÿè°¢ææ’é“æä¾›çš„æ”¯æŒ</div>

    <br />
    <div>
      æœ¬é¡¹ç›®åŸºäºGPL-3.0ï¼Œå®Œå…¨å¼€æºï¼Œå…è´¹ï¼Œä»…ä¾›æŠ€æœ¯å­¦ä¹ å’Œäº¤æµï¼Œå¼€å‘è€…å›¢é˜Ÿå¹¶æœªæˆæƒä»»ä½•ç»„ç»‡ã€æœºæ„ä»¥åŠä¸ªäººå°†å…¶ç”¨äºå•†ä¸šæˆ–è€…ç›ˆåˆ©æ€§è´¨çš„æ´»åŠ¨ã€‚ä¹Ÿä»æœªä½¿ç”¨æœ¬é¡¹ç›®è¿›è¡Œä»»ä½•ç›ˆåˆ©æ€§æ´»åŠ¨ã€‚æœªæ¥ä¹Ÿä¸ä¼šå°†å…¶ç”¨äºå¼€å±•è¥åˆ©æ€§ä¸šåŠ¡ã€‚
    </div>
    <div>
      ä¸ªäººæˆ–è€…ç»„ç»‡ï¼Œæœºæ„å¦‚æœä½¿ç”¨æœ¬é¡¹ç›®äº§ç”Ÿçš„å„ç±»çº çº·ï¼Œæ³•å¾‹é—®é¢˜ï¼Œå‡ç”±å…¶æœ¬äººæ‰¿æ‹…ã€‚
    </div>
    <div>
      å¦‚æœæ‚¨å¼€å§‹ä½¿ç”¨æœ¬é¡¹ç›®ï¼Œå³è§†ä¸ºåŒæ„é¡¹ç›®å…è´£å£°æ˜ä¸­çš„ä¸€åˆ‡æ¡æ¬¾ï¼Œæ¡æ¬¾æ›´æ–°ä¸å†å¦è¡Œé€šçŸ¥ã€‚
    </div>
    <div>å¦‚æœ‰è§¦åŠç›¸å…³å¹³å°è§„å®šæˆ–è€…æƒç›Šï¼Œçƒ¦è¯·è”ç³»æˆ‘ä»¬åˆ é™¤ã€‚</div>

    <span slot="footer" class="dialog-footer">
      <el-button @click="accept()" type="primary"> æ¥å—å¹¶ä½¿ç”¨ </el-button>
    </span>
  </el-dialog>
</template>

<script lang="ts">
import introJs from "intro.js";
import "intro.js/minified/introjs.min.css";

import { Component, Vue } from "vue-property-decorator";

import eventBus from "@renderer/EventBus";

import taskModule from "@src/renderer/store/task";
import userModule from "@src/renderer/store/user";

@Component({})
export default class TaskForm extends Vue {
  dialogVisibility = true;

  accept() {
    this.dialogVisibility = false;
    this.$nextTick(() => {
      this.intro();
    });
  }

  intro() {
    userModule.user.hasTakenGuide ||
      introJs()
        .setOptions({
          showProgress: true,
          showBullets: false,
          disableInteraction: true,
          nextLabel: "ç»§ç»­",
          prevLabel: "è¿”å›",
          exitOnOverlayClick: true,
          steps: [
            {
              title: "ä½ å¥½",
              intro: "æ¬¢è¿ä½¿ç”¨ç­¾åˆ°å°å·¥å…· ğŸ‘‹ï¼Œæ­¤æ•™ç¨‹ä¼šç®€å•ä»‹ç»å¦‚ä½•ä½¿ç”¨æœ¬å·¥å…·",
            },
            {
              element: document.querySelector("#login-container"),
              intro:
                "é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸€ç§ç™»å½•æ–¹å¼ï¼Œæœ€ç»ˆç›®çš„éƒ½æ˜¯è·å–æœ‰æ•ˆçš„cookie",
            },
            {
              element: document.querySelector("#login-button"),
              intro:
                "å¦‚æœé€‰æ‹©é€šè¿‡è´¦å·å¯†ç ç™»å½•ï¼Œç™»å½•æˆåŠŸä¹‹åï¼Œä¼šè‡ªåŠ¨åŒæ­¥cookieï¼Œä¸éœ€è¦å†æ“ä½œ",
            },
            {
              element: document.querySelector("#cookie-check-button"),
              intro: "å¦‚æœç›´æ¥æä¾›cookieï¼Œéœ€è¦å…ˆéªŒè¯cookieæœ‰æ•ˆæ€§",
            },
            {
              element: document.querySelector("#cookie-update-button"),
              intro: "éªŒè¯æˆåŠŸåï¼Œç‚¹å‡»æ›¿æ¢cookieå³å¯",
            },
            // index 5
            {
              intro: "æ¥ä¸‹æ¥ä»‹ç»æ´»åŠ¨éƒ¨åˆ†",
            },
            // index 6
            {
              element: document.querySelector("#get-course-button"),
              intro:
                "åœ¨é…ç½®å®Œæˆcookieï¼Œå¹¶ä¸”éªŒè¯cookieæœ‰æ•ˆæ€§ä¹‹åï¼Œé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è·å–å½“å‰è´¦å·ä¸‹çš„æ‰€æœ‰è¯¾ç¨‹",
            },
            // index 7
            {
              element: document.querySelector(".course-container"),
              intro:
                "è·å–åˆ°è¯¾ç¨‹ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©æ·»åŠ è‡³ä»»åŠ¡é˜Ÿåˆ—ï¼Œæˆ–è€…æ‰‹åŠ¨å¤„ç†ç­¾åˆ°",
            },
            // index 8
            {
              element: document.querySelector(".course-create-button"),
              intro: "å¦‚æœé€‰æ‹©æ·»åŠ è‡³ä»»åŠ¡é˜Ÿåˆ—ï¼Œåˆ™ä¼šæ˜¾ç¤ºä»»åŠ¡ç¼–è¾‘è¡¨å•",
            },
            {
              intro: "æ¥ä¸‹æ¥ä»‹ç»ä»»åŠ¡ç¼–è¾‘è¡¨å•",
            },
            // index 10
            {
              element: document.querySelector("#form-date-range"),
              intro:
                "é€‰æ‹©åˆé€‚çš„ä¸Šè¯¾å‘¨æœŸ(æœ€å¥½å’Œå®é™…å­¦æœŸä¸€è‡´ï¼Œæˆ–è€…å’Œè¯¥é—¨è¯¾çš„å‘¨æœŸä¸€è‡´)",
            },
            {
              intro:
                "ä¸€é—¨è¯¾ç¨‹å»ºè®®åªé…ç½®ä¸€ä¸ªä»»åŠ¡ï¼Œä½†æ˜¯å¯ä»¥ä¸ºè¯¥ä»»åŠ¡é…ç½®å¤šä¸ªä¸Šè¯¾æ—¶é—´",
            },
            // 12
            {
              intro:
                "é€‰æ‹©åˆé€‚çš„ä¸Šè¯¾æ—¶é—´(æ¯”å¦‚å¯ä»¥æ¯”å®é™…ä¸Šè¯¾æ—¶é—´æå‰åŠå°æ—¶)ï¼Œå°å·¥å…·ä¼šæ ¹æ®ä»»åŠ¡çš„å‘¨æœŸå’Œæ—¶é—´ï¼Œè‡ªåŠ¨ä¼˜åŒ–æ•´åˆæ—¶é—´èŒƒå›´ï¼Œä¿è¯ç›‘æ§çš„æ•ˆç‡å’Œç²¾ç¡®",
            },
            // 13
            {
              intro:
                "å»ºè®®é€‰æ‹©è¾ƒå¤§çš„ç›‘æ§é¢‘ç‡(è‡³å°‘60s)ï¼Œä¸ç„¶ä¼šè¢«å±è”½ï¼Œè€Œè·å–ä¸åˆ°æ´»åŠ¨ä¿¡æ¯",
            },
            // 14
            {
              intro: "æ·»åŠ ä»»åŠ¡ä¹‹åï¼Œä¼šç«‹å³ç”Ÿæ•ˆï¼Œå¹¶ä¸éœ€è¦é‡å¯å°å·¥å…·",
            },
            // 15
            {
              intro: "å¦‚æœé€‰æ‹©æ‰‹åŠ¨å¤„ç†ç­¾åˆ°",
            },
            {
              element: document.querySelector("#activity-container"),
              intro: "å¯ä»¥åœ¨æ­¤å¤„çœ‹åˆ°æ‰€æœ‰è¯¥è¯¾ç¨‹çš„ç­¾åˆ°æ´»åŠ¨",
            },
            // 17
            {
              intro: "å¯ä»¥æ‰‹åŠ¨å¯¹ä»»æ„æ´»åŠ¨è¿›è¡Œç­¾åˆ°",
            },
            {
              element: document.querySelector("#activity-container"),
              intro: "æœ‰æ—¶ä¸€é—¨è¯¾ç¨‹ï¼Œå¯èƒ½å¹¶æ²¡æœ‰å¯¹åº”çš„æ´»åŠ¨",
              position: "left",
            },
            // 19
            {
              intro: "æ¥ä¸‹æ¥ä»‹ç»ä»»åŠ¡éƒ¨åˆ†",
            },
            // 20
            {
              intro: "å¯ä»¥åœ¨æ­¤å¤„çœ‹åˆ°ï¼Œæ‰€æœ‰é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡",
            },
            // 21
            {
              intro: "ç¼–è¾‘ã€åˆ é™¤ä»»åŠ¡ä¹‹åï¼Œæ˜¯å³æ—¶ç”Ÿæ•ˆçš„ï¼Œä¸éœ€è¦é‡å¯å°å·¥å…·",
            },
            // 22
            {
              intro: "ç¼–è¾‘ä»»åŠ¡çš„è¡¨å•çš„ä½¿ç”¨ï¼Œå’Œåˆ›å»ºæ—¶ä¸€è‡´",
            },
            // 23
            {
              intro: "æ¥ä¸‹æ¥ä»‹ç»æ—¥å¿—éƒ¨åˆ†",
            },
            // 24
            {
              intro: "è¿™é‡ŒåŒ…æ‹¬äº†æ‰€æœ‰å°å·¥å…·å†…éƒ¨çš„è¿è¡Œæ—¥å¿—ï¼Œä»¥åŠç”¨æˆ·çš„æ“ä½œæ—¥å¿—",
            },
            {
              intro: "å¯ä»¥é€‰æ‹©æ—¥å¿—ç­‰çº§",
            },
            // 26
            {
              intro: "ä¹Ÿå¯ä»¥é€‰æ‹©ï¼Œå½“æœ‰æ–°æ—¥å¿—æ—¶ï¼Œæ˜¯å¦è‡ªåŠ¨ä¸‹ç§»",
            },
            // 27
            {
              intro:
                "è¿™é‡Œä¼šæ˜¾ç¤ºå½“å‰æ´»è·ƒè¯¾ç¨‹ï¼Œæ´»è·ƒè¯¾ç¨‹ï¼Œå³å½“å‰æ­£åœ¨è¯¥è¯¾ç¨‹çš„ä¸Šè¯¾æ—¶é—´èŒƒå›´å†…",
            },
            // 28
            {
              intro: "ä»‹ç»åˆ°æ­¤ä¸ºæ­¢ï¼Œç¥ä½ ä½¿ç”¨æ„‰å¿«ğŸ‘‹ï¼Œå¯ä»¥ä¸ºæˆ‘ç‚¹ä¸€ä¸ªstarå“¦",
            },
          ],
        })
        .onbeforechange(function () {
          console.log(this._currentStep);
          console.log(this);

          switch (this._currentStep) {
            case 5: // å¼€å§‹ä»‹ç»æ´»åŠ¨é¡µé¢
              document.querySelector<HTMLElement>("#tab-1").click();
              break;

            case 6: // æå‰ä¼ªé€ ï¼ŒintroJsçš„tickå’Œvueå¹¶ä¸ä¸€è‡´
              eventBus.$emit("fake-course");
              break;

            case 7: // ä¼ªé€ course å’Œ activities
              console.log(document.querySelector(".course-container"));
              break;

            case 8:
              this._introItems[this._currentStep].element =
                document.querySelector(".course-create-button");
              this._introItems[this._currentStep].position = "right";
              break;

            case 9: // æ˜¾ç¤ºä»»åŠ¡ç¼–è¾‘è¡¨å•
              taskModule.enableItemEdit({
                action: "create",
                item: {} as any,
              });
              break;

            case 10:
              this._introItems[this._currentStep].element =
                document.querySelector("#form-date-range");
              this._introItems[this._currentStep].position = "bottom";

              break;

            case 11:
              this._introItems[this._currentStep].element =
                document.querySelector("#form-course-time-container");
              this._introItems[this._currentStep].position = "bottom";
              break;

            case 12:
              this._introItems[this._currentStep].element =
                document.querySelector(".form-course-time-range");
              this._introItems[this._currentStep].position = "bottom";
              break;

            case 13:
              this._introItems[this._currentStep].element =
                document.querySelector("#form-frequency");
              this._introItems[this._currentStep].position = "bottom";
              break;

            case 14:
              this._introItems[this._currentStep].element =
                document.querySelector("#form-confirm-button");
              this._introItems[this._currentStep].position = "bottom";
              break;

            case 15:
              taskModule.cancelItemEdit();
              eventBus.$emit("fake-activities");

              this._introItems[this._currentStep].element =
                document.querySelector(".course-check-button");
              this._introItems[this._currentStep].position = "right";

              break;

            case 16:
              break;

            case 17:
              this._introItems[this._currentStep].element =
                document.querySelector(".course-sign-button");
              this._introItems[this._currentStep].position = "bottom";
              break;

            case 18:
              eventBus.$emit("empty-activities");
              break;

            case 19: // å¼€å§‹ä»‹ç»ä»»åŠ¡é¡µé¢
              document.querySelector<HTMLElement>("#tab-2").click();
              eventBus.$emit("fake-tasks");

              break;

            case 20:
              this._introItems[this._currentStep].element =
                document.querySelector("#task-table");
              this._introItems[this._currentStep].position = "bottom";
              break;

            case 21:
              this._introItems[this._currentStep].element =
                document.querySelector(".task-actions");
              this._introItems[this._currentStep].position = "bottom";
              break;

            case 22:
              this._introItems[this._currentStep].element =
                document.querySelector(".task-edit");
              this._introItems[this._currentStep].position = "bottom";
              break;

            case 23: // å¼€å§‹ä»‹ç»æ—¥å¿—é¡µé¢
              document.querySelector<HTMLElement>("#tab-3").click();

              break;

            case 25:
              this._introItems[this._currentStep].element =
                document.querySelector("#log-level");
              this._introItems[this._currentStep].position = "bottom";
              break;

            case 26:
              this._introItems[this._currentStep].element =
                document.querySelector("#log-auto-slide");
              this._introItems[this._currentStep].position = "bottom";
              break;

            case 27:
              this._introItems[this._currentStep].element =
                document.querySelector("#log-active-courses");
              this._introItems[this._currentStep].position = "bottom";
              break;
          }
        })
        .oncomplete(function () {
          eventBus.$emit("back-to-normal");
          userModule.updateUser({ hasTakenGuide: true });
        })
        .start();
  }
}
</script>

<style>
</style>
